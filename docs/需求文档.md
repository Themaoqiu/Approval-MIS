# 大型作业 审批系统需求说明
## 1. 需求说明
### 1.1 背景和核心需求
在企业信息化系统中，审批流程是最常见、最基础的业务场景之一，如请假审批、报销审批、用章审批等。构建一个可配置的动态审批流程管理系统，实现企业各类审批事项的电子化、流程化和可配置化管理。支持不同业务表单的快速创建、审批流程自定义和多级审批人指定。

### 1.2 主要功能（必做）
#### 1.2.1 用户与权限管理
1. 普通员工
- 登录系统
- 发起审批申请（请假、报销）
- 查看“我的申请”
- 查看审批进度与审批历史
- 在审批尚未开始前撤回申请
2. 审批人（如部门经理，同一条可以是多个领导审批）
- 登录系统
- 查看分配给自己的审批待办
- 对审批进行同意/拒绝
- 填写审批意见
- 查看本人已处理的审批记录
3. 系统管理员
- 管理用户、部门、岗位信息
- 为用户分配角色
- 查看系统全部审批数据（只读即可）
- 新建审批流程

**权限要求**：
- 普通员工只能查看和操作自己的申请
- 审批人只能查看和处理分配给自己的任务

#### 1.2.2 基础表单申请
- 请假申请表单：包含请假类型、起止时间、天数、事由等字段
- 报销申请表单：包含费用类型、金额、事由、发票附件等字段
- 固定流程审批：每个表单有预定义好的简单审批流程（如：申请人→部门经理）

#### 1.2.3 审批任务处理
- 我的待办列表：显示当前用户需要处理的所有审批任务
- 审批操作：支持同意、拒绝两种基本操作，可填写审批意见
- 审批历史查看：查看申请的审批进度和审批记录

#### 1.2.4 我的申请管理
- 新建申请：填写并提交各类申请表单
- 申请列表：查看个人发起的申请及状态
- 申请详情：查看申请详情和审批历史
- 撤回功能：在进入审批前可撤回申请

#### 1.2.5 审批记录
系统需保存完整审批历史：审批人、审批时间、审批动作、审批意见、当前节点

### 1.3 高级功能（选做，丰富系统功能）
#### 1.3.1 统计功能
- 个人统计：统计个人申请数量、通过率等
- 基础报表：按部门、时间统计申请数量

#### 1.3.2 动态表单配置
- 表单设计器：可视化拖拽方式设计新表单
- 字段类型丰富：支持文本框、下拉框、日期、文件上传、多选框等
- 表单模板管理：创建、编辑、删除表单模板
- 表单预览：设计时可实时预览表单效果

#### 1.3.3 动态流程设计
- 流程设计器：图形化拖拽方式设计审批流程
- 节点类型：支持审批节点、条件分支节点、并行会签节点
- 条件分支：根据表单字段值（如金额、天数）自动选择不同审批路径
- 流程版本管理：支持流程模板的版本控制

#### 1.3.4 自定义审批人指派
1. 多模式指派：
- 按岗位指派：基于sys_post表
- 按组织架构：申请人上级、部门负责人
- 指定具体人员
2. 会签/或签模式：支持多人会签（全部同意）和或签（一人同意）
3. 审批人选择器：可视化选择审批人界面

#### 1.3.5 文件集成
- 上传文件：表单中，支持文件上传，支持指定文件类型
- 文件查看与下载：在审批人查看过程中，支持部分文件类型的在线查看及所有文件类型的下载

## 2. 数据库设计（示例）
### 2.1 用户信息表
| 名称 | 类型 | 不是null | 注释 |
| --- | --- | --- | --- |
| user_id | bigint | 是 | 用户ID |
| dept_id | bigint | 否 | 部门ID |
| user_name | varchar(30) | 否 | 用户账号 |
| nick_name | varchar(30) | 否 | 用户昵称 |
| user_type | varchar(2) | 否 | 用户类型(00系统用户) |
| email | varchar(50) | 否 | 用户邮箱 |
| phonenumber | varchar(11) | 否 | 手机号码 |
| sex | char(1) | 否 | 用户性别(0男1女2未知) |
| avatar | varchar(100) | 否 | 头像地址 |
| password | varchar(100) | 否 | 密码 |
| status | char(1) | 否 | 帐号状态(0正常1停用) |
| del_flag | char(1) | 否 | 删除标志(0代表存在2代表删除) |
| login_ip | varchar(128) | 否 | 最后登录IP |
| login_date | datetime | 否 | 最后登录时间 |
| create_by | varchar(64) | 否 | 创建者 |
| create_time | datetime | 否 | 创建时间 |
| update_by | varchar(64) | 否 | 更新者 |
| update_time | datetime | 否 | 更新时间 |
| remark | varchar(500) | 否 | 备注 |

### 2.2 部门信息表
| 名称 | 类型 | 不是null | 注释 |
| --- | --- | --- | --- |
| dept_id | bigint | 是 | 部门id |
| parent_id | bigint | 否 | 父部门id |
| ancestors | varchar(50) | 否 | 祖级列表 |
| dept_name | varchar(30) | 否 | 部门名称 |
| order_num | int | 否 | 显示顺序 |
| leader | varchar(20) | 否 | 负责人 |
| phone | varchar(11) | 否 | 联系电话 |
| email | varchar(50) | 否 | 邮箱 |
| status | char(1) | 否 | 部门状态（0正常 1停用） |
| del_flag | char(1) | 否 | 删除标志（0代表存在 2代表删除） |
| create_by | varchar(64) | 否 | 创建者 |
| create_time | datetime | 否 | 创建时间 |
| update_by | varchar(64) | 否 | 更新者 |
| update_time | datetime | 否 | 更新时间 |

### 2.3 岗位信息表
| 名称 | 类型 | 不是null | 注释 |
| --- | --- | --- | --- |
| post_id | bigint | 否 | 岗位ID |
| post_code | varchar(64) | 否 | 岗位编码 |
| post_name | varchar(50) | 否 | 岗位名称 |
| post_sort | int | 否 | 显示顺序 |
| status | char(1) | 否 | 状态（0正常 1停用） |
| create_by | varchar(64) | 否 | 创建者 |
| create_time | datetime | 否 | 创建时间 |
| update_by | varchar(64) | 否 | 更新者 |
| update_time | datetime | 否 | 更新时间 |
| remark | varchar(500) | 否 | 备注 |

### 2.4 用户岗位关联表
| 名称 | 类型 | 不是null | 注释 |
| --- | --- | --- | --- |
| user_id | bigint | 是 | 用户ID |
| post_id | bigint | 是 | 岗位ID |
